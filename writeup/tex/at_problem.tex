% ===================================================
\section{Problem Statement}
% ===================================================
In this chapter, we consider a two-agent pursuit-evasion problem that involves  a Target (aircraft) in opposition to an Attacker (missile). The Target tries to evade the Attacker and avoid being captured by him. We will try to find a simple technique for target evasion, so we should have a look at evasion techniques.
The missile is on the ground, its position is (0,0). The plane is flaying is the air, its position is (10000,40000).

\subsection{Evasion techniques}
There is some observations we should make before talking about evasion techniques 
\begin{itemize}
	\item The missile is faster than the aircraft, but cannot turn tighter than the aircraft, so it takes a longer path.
	\item The control mechanism of the Missile is much simpler and is of less capability than that of the aircraft. In order to pull as tight turn as the aircraft, it must exercise an acceleration that is far beyond its capability.
	\item The missile always attempts to trace the target. Thus if the target changes heading, it will necessary for the Missile to change heading similarly, but this is too difficult for him to achieve.
	\item  The main problem with evading missiles is their speed, which makes timing somewhat difficult.
\end{itemize}
\textbf{Some tactics to evade a missile:}
\begin{enumerate}
	\item \textbf{If missile is fired head-on at BVR range:}
	\begin{itemize}
		\item Turn hard to either left or right so as to fly at roughly 90 degrees angle to attacking aircraft (This forces missile to bleed off the energy and to lead the target).
		\item Once target aircraft makes a hard turn to reverse a direction, missile with its far larger turn circle – will be unable to compensate.
	\end{itemize}
					\begin{figure}[H]
					 	\centering
					 	\includegraphics[scale = 0.25]{fig/evasiontech1.jpg}
					 	\caption{Illustration of the first maneuver technique}
					 	%\label{}
					 \end{figure}
	\item \textbf{ Jinking (useful at short ranges):}
	\begin{itemize}
		\item Aircraft must be positioned so that it is at angle (30-60 degrees is optimum) relative to missile’s flight path.
		\item Once missile gets closer, aircraft will make a hard turn in opposite direction.
		\item As there is a lag between aircraft changing the direction and missile following (for several reasons, most important of which is missile’s inertia), this will cause missile to head in wrong direction until it manages to correct, and also to bleed off the energy.
		\item Missile will fly past the aircraft and miss.
	\end{itemize}
					\begin{figure}[H]
						 \centering
						 \includegraphics[scale = 0.7]{fig/evasiontech2.jpg}
						 \caption{Illustration of the second maneuver technique}
					\end{figure}
	\item  \textbf{Climb (useful at longer ranges):}
	\begin{itemize}
		\item Since at long range missile will have burned out its engine, it will rely on inertia to keep it flying, and climbing will mean that it will bleed off energy rapidly.
		\item Once missile reaches a close range (maybe around 1,500 meters), dive for the ground, then pull up (This will allow pilot to gain energy and using it to evade the missile).
	\end{itemize}
			\begin{figure}[H]
				\centering
				\includegraphics[scale = 0.7]{fig/evasiontech3.jpg}
				\caption{Illustration of the third maneuver technique}
			\end{figure}
	\item \textbf{Fourth tactic:}
	\begin{itemize}
		\item place the missile at 3 o’clock or 9 o’clock position
		\item maintain sufficient turn to keep the missile 
		\item This tactic forces the missile to execute a continuous turn, bleeding the energy entire time, making it easier to outturn the missile once it comes close.
	\end{itemize}
			\begin{figure}[H]
			\centering
			\includegraphics[scale = 0.7]{fig/evasiontech4.jpg}
			\caption{Illustration of the forth maneuver technique}
			\end{figure}
\end{enumerate}


%Why use polynomials?
Now we want to search for a path that the Target can move on it to escape from the Attacker. All the evasion techniques depend on the time of the turn that the Target makes when it detects the Attacker (Missile) and the objective is to maximize the Missile acceleration till the Missile power bleed. 
We will  choose the escaping trajectory as a polynomial with unknown coefficients, then try to find these coefficients which make the Missile exert a maximum acceleration to bleed its power as fast as we can before it reaches the Target.  
% ===================================================
\section{Assumptions, Notation, and Nomenclature}
% ===================================================
\subsection*{Assumptions}

\begin{enumerate}
	\item Both the Attacker and Target travel at constant speeds.
	\item The Attacker's speed is larger than that of the Target. Otherwise, the Target will be unconditionally or trivially capable of escaping. 
	\item Gravitational and drag effects are neglected for simplicity.
	\item The maximum g-force a typical person can handle is 5G
	\item The maximum g-force a pilot fighter (with safety equipments) could resist is 10G.
	\item The maximum g-force for a sprint missile is 100G.
	\item The range for Tactical missile defense, which has short ranges is $18\to 20$ Kilometer, approximately $59000 \to 66000$ feet. 
	
\end{enumerate}
% ===================================================

% ===================================================
\subsection*{Notation}
% ===================================================
\begin{itemize}
	\item $n_c$ : Acceleration command (for the Missile) in $m/s^2$.
	\item $N'$ : Effective navigation ratio, a unit-less designer-chosen gain (usually in the range of $3\to5$).
	\item $V_c$ : Missile-Target closing velocity.
	\item $\lambda$ : line-of-sight angle.
	\item $\dot{\lambda}$ : line of sight rate.
	\item $R_{TM}$ : length of the line of sight.
	\item $L$ : Missile lead angle.
	\item $HE$ : Heading error.
	\item $\dot{\beta}$ : angular velocity of the Target.
	\item $V_{T1},V_{T2}$ : Target velocity components in the Earth fixed coordinate system.
	\item $V_{M1},V_{M2}$ : Missile velocity components in the Earth fixed coordinate system.
\end{itemize}
% ===================================================
\subsection*{Nomenclature}

\textbf{Inertial coordinate system:} fixed to the surface of a flat-Earth model ( the 1 axis is downrange and the 2 axis can either be altitude or cross-range).

\textbf{Missile lead angle:} theoretically correct angle
for the missile to be on a collision triangle with the Target.

\textbf{Heading error ($HE$) :} angle representing the initial deviation of the Missile from the collision triangle.

\textbf{line of sight:} The imaginary line connecting the Missile and Target.

\textbf{length of the line of sight ($R_{TM}$):} Instantaneous separation between Missile and Target.

\textbf{Miss distance :} The point of closest approach of the Missile and Target.

\textbf{Closing velocity ($V_c$):} the negative rate of change of the distance
from the Missile to the Target $Vc= -\dot{R_{TM}}=-\frac{d}{dt} R_{TM} $.


% ===================================================


% ===================================================
\section{Proportional Navigation}
% ===================================================
In this section, we will illustrate some fundamentals of missile guidance, focusing on the proportional navigation technique, which is one of the simplest guidance laws.

\subsection*{What is proportional navigation?}
The proportional navigation guidance law issues acceleration commands,
perpendicular to the instantaneous missile-target line-of-sight, which are
proportional to the line-of-sight rate and closing velocity. Mathematically, the
guidance law can be stated as

\begin{equation}
	n_c= N' V_c \dot{\lambda}
	\label{PNeq}
\end{equation}

where $n_c$ is the acceleration command (for the missile) in $(m/s^2)$, $N'$ is the the effective navigation ratio, a unit-less designer-chosen gain (usually in the range of $3 \to 5$), $V_c$ is the missile-target closing velocity in $(m/s)$ and $\dot{\lambda} = \frac{d\lambda}{dt}$ is the rate of the line-of-sight angle and is in $(rad/s)$. Note that (\ref{PNeq}) is dimensionally homogeneous, since $n_c$ has the dimension
\begin{equation}
	\begin{split}
	[n_c] &= [N'] [V_c] [\dot{\lambda}]\\
	&=(1) (LT^-1) (T^-1)\\
	&=LT^-2
	\end{split}
	\label{PN dimensionallity}
\end{equation}
which is the appropriate dimension of linear acceleration.

\subsection{Simulation of proportional navigation equations in 2-D}
In this subsection we will introduce the equations of proportional navigation and the sequence to get a simulation for the path of the Target and the Attacker and how the missile acceleration will be affected during this simulation.

\textbf{The simulation inputs} are the initial location of the Missile ($R_{M1}, R_{M2}$) and the initial location of the Target ($R_{T1}, R_{T2}$), Target speed $V_T$, Missile speed $V_M$, and effective navigation ratio $N'$.

There are two types of \textbf{error sources} that cause the Attacker to miss the Target; they are the heading error ($HE$) and the acceleration of the Target ($n_T$) called the Target maneuver.

\begin{figure}[htb]
	\centering
	\includegraphics[scale = 0.65]{fig/PN.pdf}
	\caption{Two dimensional Missile-Target engagement geometry.}
	\label{PN}
\end{figure}


\subsubsection*{proportional navigation differential equations}

\textbf{The components of Target velocity} 
\begin{equation}
	V_{T1} = - V_T \cos(\beta)
\end{equation}

\begin{equation}
V_{T2} =  V_T \sin(\beta)
\end{equation}

\textbf{Relative missile-target separation}
\begin{equation}
	R_{TM1} = R{T1} - R_{M1}
\end{equation}
\begin{equation}
R_{TM2} = R{T2} - R_{M2}
\end{equation}

from the previous 2 equations we get
\begin{equation}
	R_{TM} = \sqrt{R_{TM1}^2 + R_{TM2}^2}
	\label{RTM}
\end{equation}

\textbf{line of sight angle}
\begin{equation}
	\lambda = \tan^{-1} (\dfrac{R_{TM2}}{R_{TM1}})
	\label{lambda}
\end{equation}

\textbf{missile lead angle} 
\begin{equation}
	L= \sin^{-1}(\dfrac{V_T \sin(\beta + \lambda)}{V_M})
\end{equation}

the angle between the downrange axis and $V_M$ vector is $\theta = \lambda + L$

\textbf{Missile velocity components} 

\begin{equation}
	V_{M1} = V_M \cos (\theta + HE)
\end{equation}

\begin{equation}
V_{M2} = V_M \sin (\theta + HE)
\end{equation}

\textbf{Relative velocity components}
\begin{equation}
	V_{TM1} = V_{T1} - V_{M1}
\end{equation}

\begin{equation}
V_{TM2} = V_{T2} - V_{M12}
\end{equation}


\textbf{closing velocity} it is the negative rate of change of the distance
from the missile to the target $Vc= -R_{TM} $, so we have to differentiate eq(\ref{RTM})

\begin{center}
	$\dot{R_{TM}}= \frac{1}{2} (R_{TM1}^2 + R_{TM2}^2)^{\frac{-1}{2}} [2 R_{TM1} \dot{R_{TM1}} + 2 R_{TM2} \dot{R_{TM2}}]$
\end{center}

we see that
%\begin{equation*}
% \dot{R_{TM1}=V_{TM1} , \dot{R_{TM2}=V_{TM2}
%\end{equation*}
%and 
%\begin{equation*}
%(R_{TM1}^2 + R_{TM2}^2)^{\frac{-1}{2}} = \dfrac{1}{R_{TM}}
%\end{equation*}
so we get 
\begin{equation}
	V_c = - \dot{R_{TM}} = - \dfrac{R_{TM1} V_{TM1}+R_{TM2} V_{TM2}}{R_{TM}}
\end{equation}

\textbf{line of sight rate} we have to differentiate eq(\ref{lambda}) using the rule $\tan^{-1}x = \frac{dx}{1+x^2}$ 

\begin{equation}
	\begin{split}
	\dot{\lambda} &= [\dfrac{1}{1+(\frac{R_{TM2}}{R_{TM1}})^2}] \dot{(\frac{R_{TM2}}{R_{TM1}})}\\
	&= \dfrac{R_{TM1}^2}{R_{TM1}^2 + R_{TM2}^2}[\dfrac{R_{TM1}\dot{R_{TM2}}- R_{TM2} \dot{R_{TM1}}}{R_{TM1}^2}]\\
	&=\dfrac{R_{TM1} V_{TM2} - R_{TM2} V_{TM1}}{R_{TM1}^2}
	\end{split}
\end{equation}

\textbf{magnitude of the missile guidance command}
\begin{equation}
		n_c= N' V_c \dot{\lambda}
\end{equation}

\textbf{missile acceleration components}
\begin{equation}
	a_{M1} = - n_c \sin \lambda
\end{equation}

\begin{equation}
a_{M2} = - n_c \cos \lambda
\end{equation}

\textbf{angular velocity of the target}
\begin{equation}
	\dot{\beta} = \dfrac{n_T}{V_T}
\end{equation}

we will solve all the equations in this section using second-order Runge-Kutta numerical integration procedure. If we have a first order differential equation of the form 
\begin{equation*}
	\dot{x} = f(x,t) 
\end{equation*} 
 where t is time, we seek to find a recursive relationship for x as a function of time.
 With the second-order Runge–Kutta numerical technique, the value of x at the
 next integration interval h is given by
 \begin{equation*}
 	x_{k+1} = x_k + \dfrac{hf(x,t)}{2} + \dfrac{h f(x, t+h)}{2}
 \end{equation*}
% ===================================================
\section{Models \& Simulations}
% ===================================================

In this section we will simulate equations in sec. 2.3 for proportional navigation using MATLAB and Simulink.
The following figure is a flowchart illustrating the steps of calculations using the equations in sec. 2.3  till we plot the trajectories.

\begin{figure}[H]
	\centering
	\includegraphics[scale = 0.65]{fig/FlowchartPN.pdf}
	\caption{Flowchart illustrating the steps of calculations using the equations in sec. 2.3  till we plot the trajectories.}
	\label{flowchart PN}
\end{figure}


\subsection{Simulation for some target maneuver cases [using MATLAB]}
In this subsection we will use MATLAB to simulate equations in sec. 2.3 for proportional navigation. We will solve the differential equations using second-order Runge-Kutta numerical integration technique, then we will draw the trajectories of the pursuit and evader for 4 cases for the Target maneuver error source, and we will deduce the effect of the effective navigation ratio $N'$ and the other type of the error source; Heading error. 
\subsubsection{Zero Target maneuver}
In this case the evader (Target - plane) does not do any effort to scape, it just moves in a straight line, as we see in Fig. \ref{trajectoryXNT0HE0N4}. So the pursuer (Attacker - Missile) does not have to bleed much energy to reach the Target.

In the case of \textbf{zero Heading error} the effective navigation ratio has no effect on the simulation engagement at all. The missile's acceleration will be zero as in Fig. \ref{missile accelerationXNT0HE0N4}.

\begin{figure}[H]
	\centering
	\includegraphics[scale = 0.7]{fig/trajectoryXNT0HE0N4.pdf}
	\caption{Trajectory of the target and attacker in case of zero target maneuver with zero heading error and $N'=4$.}
	\label{trajectoryXNT0HE0N4}
\end{figure}


\begin{figure}[H]
	\centering
	\includegraphics[scale = 0.58]{fig/MissileAccelerationXNT0HE0N4.pdf}
	\caption{Missile acceleration in case of zero target maneuver with zero heading error and $N'=4$ .}
	\label{missile accelerationXNT0HE0N4}
\end{figure}


\begin{figure}[H]
	\centering
	\includegraphics[scale = 0.58]{fig/TargetAccelerationXNT0HE0N4.pdf}
	\caption{Target acceleration in case of zero target maneuver with zero heading error and $N'=4$ .}
	\label{Target accelerationXNT0HE0N4}
\end{figure}


In the case of \textbf{Heading error = -20} increasing the effective navigation ratio causes heading error to be removed rapidly as we see from  Fig. \ref{trajectory20N3}, Fig. \ref{trajectory20N4} and Fig. \ref{trajectory20N5}. The effective navigation ratio has an effect on the acceleration of the missile; the way that the missile will bleed energy as we see from Fig. \ref{missile acceleration20N3} , Fig. \ref{missile acceleration20N4} and Fig. \ref{missile acceleration20N5}. The total acceleration (area under the curve) is increasing inversely proportional with the effective navigation ratio $N'$ .


\begin{figure}[H]
	\centering
	\includegraphics[scale = 0.48]{fig/trajectoryXNT0HE20N3.pdf}
	\caption{Trajectory of the target and attacker in case of zero target maneuver with heading error=-20 and $N'=3$.}
	\label{trajectory20N3}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[scale = 0.48]{fig/MissileAccelerationXNT0HE20N3.pdf}
	\caption{Missile acceleration in case of zero target maneuver with heading error=-20 and $N'=3$ .}
	\label{missile acceleration20N3}
\end{figure}


\begin{figure}[H]
	\centering
	\includegraphics[scale = 0.57]{fig/trajectoryXNT0HE20N4.pdf}
	\caption{Trajectory of the target and attacker in case of zero target maneuver with heading error=-20 and $N'=4$.}
	\label{trajectory20N4}
\end{figure}


\begin{figure}[H]
	\centering
	\includegraphics[scale = 0.57]{fig/MissileAccelerationXNT0HE20N4.pdf}
	\caption{Missile acceleration in case of zero target maneuver with heading error=-20 and $N'=4$ .}
	\label{missile acceleration20N4}
\end{figure}


\begin{figure}[H]
	\centering
	\includegraphics[scale = 0.57]{fig/trajectoryXNT0HE20N5.pdf}
	\caption{Trajectory of the target and attacker in case of zero target maneuver with heading error=-20 and $N'=5$.}
	\label{trajectory20N5}
\end{figure}


\begin{figure}[H]
	\centering
	\includegraphics[scale = 0.57]{fig/MissileAccelerationXNT0HE20N5.pdf}
	\caption{Missile acceleration in case of zero target maneuver with heading error=-20 and $N'=5$ .}
	\label{missile acceleration20N5}
\end{figure}

%-----------------------------------------------------------

\subsubsection{Constant Target maneuver}
In this case the target does some effort to escape from the attacker, in the form of constant acceleration (in our example target acceleration = $5G$).
We see from Fig. \ref{missile acceleration0NN3} and Fig. \ref{missile acceleration0NN5} that a higher effective navigation ratio yields less acceleration to hit maneuvering target, and causes the missile to lead the target slightly more than a lower effective navigation ratio does, as we see from Fig. \ref{trajectory0NN3} and Fig. \ref{trajectory0NN5}.



\begin{figure}[htb]
	\centering
	\includegraphics[scale = 0.75]{fig/trajectoryXNT5HE0N3.pdf}
	\caption{Trajectory of the target and attacker in case of constant target maneuver=5G with heading error=0 and $N'=3$.}
	\label{trajectory0NN3}
\end{figure}


\begin{figure}[htb]
	\centering
	\includegraphics[scale = 0.65]{fig/MissileAccelerationXNT5HE0N3.pdf}
	\caption{Missile acceleration in case of constant target maneuver=5G with heading error=0 and $N'=3$ .}
	\label{missile acceleration0NN3}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[scale = 0.65]{fig/TargetAccelerationXNT5HE0N3.pdf}
	\caption{Target acceleration in case of zero target maneuver with zero heading error and $N'=3$ .}
	\label{Target accelerationXNT5HE0N3}
\end{figure}


%----------

\begin{figure}[htb]
	\centering
	\includegraphics[scale = 0.35]{fig/trajectoryXNT5HE0N5.pdf}
	\caption{Trajectory of the target and attacker in case of constant target maneuver=5G with heading error=0 and $N'=5$.}
	\label{trajectory0NN5}
\end{figure}


\begin{figure}[htb]
	\centering
	\includegraphics[scale = 0.35]{fig/MissileAccelerationXNT5HE0N5.pdf}
	\caption{Missile acceleration in case of constant target maneuver=5G with heading error=0 and $N'=5$ .}
	\label{missile acceleration0NN5}
\end{figure}


\begin{figure}[H]
	\centering
	\includegraphics[scale = 0.35]{fig/TargetAccelerationXNT5HE0N5.pdf}
	\caption{Target acceleration in case of zero target maneuver with zero heading error and $N'=5$ .}
	\label{Target accelerationXNT5HE0N5}
\end{figure}

%-----------------------------------------------------------

\subsubsection{Polynomial Target maneuver}
Now we will make the Target maneuver as a polynomial in the form

\begin{equation}
	f(t) = c_0 + c_1 T + c_2 T^2 + c_3 T^3 + ... + c_N T^N
\end{equation} 

where T is time , c are unknown coefficients of the polynomial and N is the polynomial degree.
In our simulation we choose N reasonably $3\to5$ and the coefficients are randomly generated then we solve the proportional navigation equations to get values for two important parameters, namely the miss distance and the command acceleration for the Missile. Then, we calculate the cost function depends on these two parameters, as our target is to maximize miss distance to make the target safe, and maximize command acceleration for the missile, so it bleeds energy before it catches the target. We will do this process many times till the number of runs we need. The next figures shows the trajectories of the Target and Missile for N=3,4 and corresponding missile and target accelerations for each case.
In the first case (N=3), as we see from Fig. \ref{Target accelerationP3N3} the target have to exert $50 G$ to escape from the attacker, these amount of G'es is very high and the pilot could not withstand all this amount. Also, form Fig. \ref{missile accelerationP3} the attacker have to exert 120 G, this will not happen and the missile's energy will bleed at 100 G after 5 sec. Here the simulation did not till us a complete vision about what will happen. We have to take in consideration the amount of G's that the pilot could resist, so we will use genetic algorithm technique to generate the polynomial because it is easy to control the maximum target acceleration in this method.
The second case (N=4), is hypothetical case because the pilot will die in less than 1 sec. If the technology improved and the scientists invent a pilot suit that could resist these huge amount of G'es, then we can take this solution in consideration.        

\begin{figure}[H]
	\centering
	\includegraphics[scale = 0.55]{fig/trajectoryP3N3.pdf}
	\caption{Trajectory of the target and attacker in case of polynomial of degree N=3 target maneuver with zero heading error and $N'=3$.}
	\label{trajectoryP3}
\end{figure}


\begin{figure}[H]
	\centering
	\includegraphics[scale = 0.55]{fig/MissileAccelerationP3N3.pdf}
	\caption{Missile acceleration in case of  polynomial of degree N=3 target maneuver with zero heading error and $N'=3$.}
	\label{missile accelerationP3}
\end{figure}


\begin{figure}[H]
	\centering
	\includegraphics[scale = 0.55]{fig/TargetAccelerationP3N3.pdf}
	\caption{Target acceleration in case of  polynomial of degree N=3 target maneuver with zero heading error and $N'=3$.}
	\label{Target accelerationP3N3}
\end{figure}

%----------
\begin{figure}[htb]
	\centering
	\includegraphics[scale = 0.35]{fig/trajectoryP4N3.pdf}
	\caption{Trajectory of the target and attacker in case of  polynomial of degree N=4 target maneuver with zero heading error and $N'=3$.}
	\label{trajectoryP4}
\end{figure}


\begin{figure}[htb]
	\centering
	\includegraphics[scale = 0.35]{fig/MissileAccelerationP4N3.pdf}
	\caption{Missile acceleration in case of  polynomial of degree N=4 target maneuver with zero heading error and $N'=3$.}
	\label{missile accelerationP4}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[scale = 0.35]{fig/TargetAccelerationP4N3.pdf}
	\caption{Target acceleration in case of  polynomial of degree N=4 target maneuver with zero heading error and $N'=3$.}
	\label{Target accelerationP4N3}
\end{figure}

%----------

%\begin{figure}[htb]
%	\centering
%	\includegraphics[scale = 0.75]{fig/trajectoryP5.pdf}
%	\caption{Trajectory of the target and attacker in case of polynomial of degree N=5 target maneuver with zero heading error and $N'=3$.}
%	\label{trajectoryP5}
%\end{figure}
%
%
%\begin{figure}[htb]
%	\centering
%	\includegraphics[scale = 0.75]{fig/MissileAccelerationP5.pdf}
%	\caption{Missile acceleration in case of  polynomial of degree N=5 target maneuver with zero heading error and $N'=3$.}
%	\label{missile accelerationP5}
%\end{figure}

%------------------------------------------------------------

\subsubsection{Trapezoidal Target maneuver}
Now we will make the Target maneuver as a trapezoidal function (as a general case of tooth and square maneuvers) illustrated in Fig. \ref{trapezoidalacc}


\begin{figure}[htb]
	\centering
	\includegraphics[scale = 0.65]{fig/toothSquareTrapezoidal.pdf}
	\caption{Trapezoidal Target maneuver.}
	\label{trapezoidalacc}
\end{figure}
In the simulation we choose the value for maximum acceleration. The time of beginning the ramp (which is 0), and the time at the end of the descent, $t_1$ and $t_2$ are variables. 

We have two cases: \textbf{First case:} the maneuver is \textit{symmetric} so we have two extreme cases.
\begin{itemize}
	\item when $t_1$ is equal to zero (there is no ascend ramp)  so $t_2$ is at the middle of the maneuver; this leads to \textit{square} target maneuver.
	\item when $t_1$ equals $t_2$ at the quarter of the maneuver; this leads to \textit{tooth} target maneuver.  
\end{itemize}
Varying $t_1$ and $t_2$, starting from the square case till the tooth case, until we find the optimum solution based on or cost function which depends on the values of the miss distance and Missile acceleration. 


\textbf{Second case:} the maneuver is \textit{not symmetric} so we put a first value for $t_1$ (starting with zero) and varying $t_2$ till we scan all the domain, then change $t_1$ slightly and scan all the domain again with $t_2$ till we find the optimum solution.

What about if the optimum solution for the target maneuver did not have Identical halves? and all the slops are not related to each other. We will try to figure that using genetic algorithm in the next section.

%In the simulation we choose the value for maximum acceleration. The time of beginning the ramp (which is 0), and the time at the end of the descent, $t_1$ and $t_2$ are randomly generated. Then we calculate the cost function which depends on the values of the miss distance and Missile acceleration and we do this process several runs till we find $t_1$ and $t_2$ that maximize miss distance and missile acceleration.   
%The advantage of this form is that we can control the values of maximum acceleration to adapt with the acceleration the pilot can withstand.

%\begin{figure}[htb]
%	\centering
%	\includegraphics[scale = 0.75]{fig/trajectoryT1.pdf}
%	\caption{Trajectory of the target and attacker in case of time at the end of the descent for the trapezoidal is equal to 8 }
%	\label{trajectoryT1}
%\end{figure}
%
%
%\begin{figure}[htb]
%	\centering
%	\includegraphics[scale = 0.75]{fig/MissileAccelerationT1.pdf}
%	\caption{Missile acceleration in case of time at the end of the descent for the trapezoidal is equal to 8 }
%	\label{missile accelerationT1}
%\end{figure}
%
%\begin{figure}[htb]
%	\centering
%	\includegraphics[scale = 0.75]{fig/trajectoryT2.pdf}
%	\caption{Trajectory of the target and attacker in case of time at the end of the descent for the trapezoidal is equal to 5 }
%	\label{trajectoryT2}
%\end{figure}
%
%
%\begin{figure}[htb]
%	\centering
%	\includegraphics[scale = 0.75]{fig/MissileAccelerationT2.pdf}
%	\caption{Missile acceleration in case of time at the end of the descent for the trapezoidal is equal to 5 }
%	\label{missile accelerationT2}
%\end{figure}
%
%
%\begin{figure}[htb]
%	\centering
%	\includegraphics[scale = 0.75]{fig/trajectoryT3.pdf}
%	\caption{Trajectory of the target and attacker in case of time at the end of the descent for the trapezoidal is equal to 4 }
%	\label{trajectoryT3}
%\end{figure}
%
%
%\begin{figure}[htb]
%	\centering
%	\includegraphics[scale = 0.75]{fig/MissileAccelerationT3.pdf}
%	\caption{Missile acceleration in case of time at the end of the descent for the trapezoidal is equal to 4 }
%	\label{missile accelerationT3}
%\end{figure}
%-----------------------------------------------------

\subsection{Genetic Algorithms Solution [using Simulink]}

In this section we will use the power of blocks in Simulink to solve the differential equations in section 2.3 in an easy way (Fig. \ref{PN eq}). We will make these equations as a main block (Fig. \ref{PN main block}) and as we change the inputs, we get the same results. The advantage of using simulink is to use the main block with an alternative optimization technique (like genetic algorithms). We will simulate two cases :


\begin{landscape}
\begin{figure}[H]
	\centering
	\includegraphics[scale = 0.70]{fig/PNeq.PNG}
	\caption{The Simulink model for proportional navigation equations in sec 2.3}
	\label{PN eq}
\end{figure}
\end{landscape}


\begin{figure}[H]
	\centering
	\includegraphics[scale = 0.75]{fig/PNmainBlock.PNG}
	\caption{The Simulink main block for solving proportional navigation equations in sec 2.3}
	\label{PN main block}
\end{figure}



%We will use the main block we have created with the genetic algorithm toolbox in MATLAB in the same manner we have done, let the target maneuver ba a polynomial with unknown coefficients, then it is required to find the values of these coefficients using genetic algorithm to maximize miss distance and missile acceleration.


% ===================================================

